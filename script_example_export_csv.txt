from enersectapp.models import *
from django.db import transaction

all_types = SourceDocType.objects.all().order_by('name').distinct()

csv_writer = csv.writer(open("number_docs_per_type.csv", "wd"), delimiter=',') 

with transaction.commit_on_success():
 for item in all_types:
   sources = SourcePdf.objects.filter(modified_document_type = item).distinct()
   sources_count = sources.count()
   csv_writer.writerow([item.name,sources_count])
